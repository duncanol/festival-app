<head>
  <title>HappySadBored</title>
</head>

<body>

  <div style="float: right; margin-right:20px;">
    {{loginButtons align="right"}}
  </div>
  
  <h1>Happy<i>Sad</i><small>Bored</small></h1>
  
  {{> intro}}
  
  {{> chathistory}}
  
  {{> chatstats}}
</body>

<template name="intro">
  <h2>How are you doing?  Let the world know...</h2>
</template>


<template name="chathistory">
  
  {{#if permittedToInsertChat }}
    <input type="text" id="chat-text" placeholder="How ya doing?" />
    <button class="chat-text-submit" data-tag="happy" data-category="emotion">Happy :)</button>
    <button class="chat-text-submit" data-tag="sad" data-category="emotion">Sad :(</button>
    <button class="chat-text-submit" data-tag="bored" data-category="emotion">Bored :|</button>
  {{/if}}
  
  {{#unless permittedToInsertChat }}
    <p>Please log in (top RHS) to start chatting!</p>
  {{/unless}}
  
  <h3>People are in general feeling...</h3>
  <ul>
    {{#each messages}}
      <li class="chat-message" data-entry-id="{{_id}}" style="nth-of-type(even): text-align: right;">
        {{ text }} <small class="chat-message">({{ authorUsername }} felt <i>{{tagByCategory 'emotion'}}</i> at {{formattedDate}})</small>
        
        {{#if permittedToRemoveChat _id}} 
          {{#if deletingEntry ../_id}}
            <a href="#" id="delete-entry" data-entry-id="{{../_id}}">Delete</a>
          {{/if}}
        {{/if}}
      </li>
    {{/each}}
  </ul>
  
</template>

<template name="chatstats">

  <h4>Emotional tilt</h4>
  {{#each tags}}
    
    <div class="stat-count">
      {{tag}} : {{count}}
    </div>
    
  {{/each}}  
  
</template>

